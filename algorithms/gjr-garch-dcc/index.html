<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex/" /><link rel="search" title="Search" href="../../search/" /><link rel="next" title="Datasets" href="../../datasets/" /><link rel="prev" title="GJR-GARCH(1,1)" href="../gjr-garch/" />
        <link rel="canonical" href="https://frds.ioalgorithms/gjr-garch-dcc/" />

    <link rel="shortcut icon" href="../../_static/frds.png"/><!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>GJR-GARCH(1,1) - DCC - frds</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=415d3439" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../"><div class="brand">frds</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/frds_icon.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">frds</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../measures/">Supported Measures</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Supported Measures</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../measures/absorption_ratio/">Absorption Ratio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/contingent_claim_analysis/">Contingent Claim Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/distress_insurance_premium/">Distress Insurance Premium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/kyle_lambda/">Kyle’s Lambda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/lerner_index/">Lerner Index (Banks)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/limit_order_book_slope/">Limit Order Book Slope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/long_run_mes/">Long-Run Marginal Expected Shortfall (LRMES)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/marginal_expected_shortfall/">Marginal Expected Shortfall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/option_prices/">Option Prices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/probability_of_informed_trading/">Probability of Informed Trading (PIN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/spread_and_price_impact/">Spread and Price Impact</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/srisk/">SRISK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/systemic_expected_shortfall/">Systemic Expected Shortfall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../measures/z_score/">Z-score</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Algorithms</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../garch/">GARCH(1,1)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../garch-ccc/">GARCH(1,1) - CCC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../garch-dcc/">GARCH(1,1) - DCC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gjr-garch/">GJR-GARCH(1,1)</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">GJR-GARCH(1,1) - DCC</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../datasets/">Datasets</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Datasets</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../datasets/stock-returns/">Stock Returns</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/mgao6767/frds/">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mingze-gao.com">Mingze Gao</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="gjr-garch-1-1-dcc">
<h1>GJR-GARCH(1,1) - DCC<a class="headerlink" href="#gjr-garch-1-1-dcc" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>The Multivariate GARCH(1,1) model generalizes the univariate
<a class="reference internal" href="../garch/"><span class="doc">GARCH(1,1)</span></a> framework to multiple time series, capturing
not only the conditional variances but also the conditional covariances
between the series. One common form is the Constant Conditional
Correlation (CCC) model proposed by Bollerslev (1990), discussed in
<a class="reference internal" href="../garch-ccc/"><span class="doc">GARCH(1,1) - CCC</span></a>.</p>
<p>However, CCC model is limited by the assumption of a constant
correlation. Engle (2002) and Tse and Tsui (2002) address this by
proposing the <strong>Dynamic Conditional Correlation (DCC)</strong> model, which
allows for time-varying conditional correlation.</p>
<p><a class="reference internal" href="../garch-dcc/"><span class="doc">GARCH(1,1) - DCC</span></a> dicusses the GARCH-DCC, here,
the <a class="reference internal" href="#"><span class="doc">GJR-GARCH(1,1) - DCC</span></a> model is discussed.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Check <a class="reference internal" href="#examples">Examples</a> section for code guide and comparison to Stata and R.</p>
</div>
<section id="return-equation">
<h3>Return equation<a class="headerlink" href="#return-equation" title="Link to this heading">#</a></h3>
<p>The return equation for a <span class="math notranslate nohighlight">\(N\)</span>-dimensional time series is:</p>
<div class="math-wrapper docutils container" id="equation-mv-return-eq">
<div class="math notranslate nohighlight" id="equation-mv-return-eq">
<span class="eqno">(1)<a class="headerlink" href="#equation-mv-return-eq" title="Link to this equation">#</a></span>\[\mathbf{r}_t = \boldsymbol{\mu} + \boldsymbol{\epsilon}_t\]</div>
</div>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{r}_t\)</span> is a <span class="math notranslate nohighlight">\(N \times 1\)</span> vector of returns,
and <span class="math notranslate nohighlight">\(\boldsymbol{\mu}\)</span> is a <span class="math notranslate nohighlight">\(N \times 1\)</span> vector of mean
returns. <span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}_t\)</span> is the <span class="math notranslate nohighlight">\(N \times 1\)</span>
vector of shock terms.</p>
</section>
<section id="shock-equation">
<h3>Shock equation<a class="headerlink" href="#shock-equation" title="Link to this heading">#</a></h3>
<p>The shock term is modelled as:</p>
<div class="math-wrapper docutils container" id="equation-mv-shock-eq">
<div class="math notranslate nohighlight" id="equation-mv-shock-eq">
<span class="eqno">(2)<a class="headerlink" href="#equation-mv-shock-eq" title="Link to this equation">#</a></span>\[\boldsymbol{\epsilon}_t = \mathbf{H}_t^{1/2} \mathbf{z}_t\]</div>
</div>
<p>Here, <span class="math notranslate nohighlight">\(\mathbf{H}_t\)</span> is a <span class="math notranslate nohighlight">\(N \times N\)</span> conditional
covariance matrix, <span class="math notranslate nohighlight">\(\mathbf{H}_t^{1/2}\)</span> is a <span class="math notranslate nohighlight">\(N \times N\)</span>
positive definite matrix, and <span class="math notranslate nohighlight">\(\mathbf{z}_t\)</span> is a <span class="math notranslate nohighlight">\(N \times
1\)</span> vector of i.i.d. standard normal innovations.</p>
<div class="math-wrapper docutils container" id="equation-shock-dcc">
<div class="math notranslate nohighlight" id="equation-shock-dcc">
<span class="eqno">(3)<a class="headerlink" href="#equation-shock-dcc" title="Link to this equation">#</a></span>\[\mathbf{z}_t \sim \mathcal{N}(0, \mathbf{I}_N)\]</div>
</div>
</section>
<section id="conditional-covariance-matrix">
<h3>Conditional covariance matrix<a class="headerlink" href="#conditional-covariance-matrix" title="Link to this heading">#</a></h3>
<p>In the DCC-GJR-GARCH(1,1) model, the conditional covariance matrix
<span class="math notranslate nohighlight">\(\mathbf{H}_t\)</span> is constructed as:</p>
<div class="math-wrapper docutils container" id="equation-mv-volatility-eq">
<div class="math notranslate nohighlight" id="equation-mv-volatility-eq">
<span class="eqno">(4)<a class="headerlink" href="#equation-mv-volatility-eq" title="Link to this equation">#</a></span>\[\mathbf{H}_t = \mathbf{D}_t\mathbf{R}_t\mathbf{D}_t\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{D}_t=\text{diag}(\mathbf{h}_t)^{1/2}\)</span>, and
<span class="math notranslate nohighlight">\(\mathbf{h}_t\)</span> is a <span class="math notranslate nohighlight">\(N \times 1\)</span> vector whose elements are
univariate GJR-GARCH(1,1) variances for each time series.
<span class="math notranslate nohighlight">\(\mathbf{R}_t\)</span> is the <span class="math notranslate nohighlight">\(N \times N\)</span> conditional correlation
matrix which is time-varying in DCC-GJR-GARCH.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The log-likelihood function for the <span class="math notranslate nohighlight">\(N\)</span>-dimensional
multivariate GJR-GARCH-DCC model is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\ell = -\frac{1}{2} \sum_{t=1}^T \left[ N\ln(2\pi) + 2 \ln(|\mathbf{D}_t|) + \ln(|\mathbf{R}_t|)+ \mathbf{z}_t' \mathbf{R}_t^{-1} \mathbf{z}_t \right]\]</div>
</div>
<p>The formulation of dynamic conditional covariance above implies that
the time-varying <span class="math notranslate nohighlight">\(\mathbf{R}_t\)</span> must be inverted at each time
<span class="math notranslate nohighlight">\(t\)</span>, which has to be positive definite as well. These
constraints would make estimation extremely slow.</p>
</div>
<p>Engle (2002) achieves these constraints by modelling
<span class="math notranslate nohighlight">\(\mathbf{R}_t\)</span> via a proxy process <span class="math notranslate nohighlight">\(\mathbf{Q}_t\)</span>.
Specifically, the conditional correlation matrix <span class="math notranslate nohighlight">\(\mathbf{R}_t\)</span>
can be obtained as:</p>
<div class="math-wrapper docutils container" id="equation-conditional-correlation-dcc">
<div class="math notranslate nohighlight" id="equation-conditional-correlation-dcc">
<span class="eqno">(5)<a class="headerlink" href="#equation-conditional-correlation-dcc" title="Link to this equation">#</a></span>\[\mathbf{R}_t = \text{diag}(\mathbf{Q}_t)^{-1/2} \mathbf{Q}_t \text{diag}(\mathbf{Q}_t)^{-1/2}\]</div>
</div>
<p>and the proxy process <span class="math notranslate nohighlight">\(\mathbf{Q}_t\)</span> is</p>
<div class="math-wrapper docutils container" id="equation-dcc-equation">
<div class="math notranslate nohighlight" id="equation-dcc-equation">
<span class="eqno">(6)<a class="headerlink" href="#equation-dcc-equation" title="Link to this equation">#</a></span>\[\mathbf{Q}_t = (1 - a - b) \mathbf{\bar{Q}} + a (\mathbf{z}_{t-1}\mathbf{z}_{t-1}') + b \mathbf{Q}_{t-1}\]</div>
</div>
<p>Here, <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are DCC parameters, and
<span class="math notranslate nohighlight">\(\mathbf{\bar{Q}}\)</span> is the unconditional correlation matrix of
standardized residuals <span class="math notranslate nohighlight">\(\mathbf{z}_t\)</span>.</p>
</section>
<section id="log-likelihood-function">
<h3>Log-likelihood function<a class="headerlink" href="#log-likelihood-function" title="Link to this heading">#</a></h3>
<p>The log-likelihood function for the <span class="math notranslate nohighlight">\(N\)</span>-dimensional multivariate
GJR-GARCH DCC model is:</p>
<div class="math-wrapper docutils container" id="equation-mv-log-likelihood">
<div class="math notranslate nohighlight" id="equation-mv-log-likelihood">
<span class="eqno">(7)<a class="headerlink" href="#equation-mv-log-likelihood" title="Link to this equation">#</a></span>\[\ell = -\frac{1}{2} \sum_{t=1}^T \left[ N\ln(2\pi) + 2 \ln(|\mathbf{D}_t|) + \ln(|\mathbf{R}_t|)+ \mathbf{z}_t' \mathbf{R}_t^{-1} \mathbf{z}_t \right]\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{z}_t=\mathbf{D}_t^{-1}\mathbf{\epsilon}_t\)</span> is the
vector of standardized residuals. We can rewrite and decompose the
log-likelihood function by adding and subtracting
<span class="math notranslate nohighlight">\(\mathbf{\epsilon}_t' \mathbf{D}_t^{-1} \mathbf{D}_t^{-1}
\mathbf{\epsilon}_t = \mathbf{z}_t'\mathbf{z}_t\)</span>,</p>
<div class="math-wrapper docutils container" id="equation-mv-log-likelihood-decomposed">
<div class="math notranslate nohighlight" id="equation-mv-log-likelihood-decomposed">
<span class="eqno">(8)<a class="headerlink" href="#equation-mv-log-likelihood-decomposed" title="Link to this equation">#</a></span>\[\ell = \underbrace{-\frac{1}{2} \sum_{t=1}^T \left[ N\ln(2\pi) + 2 \ln(|\mathbf{D}_t|) + \mathbf{\epsilon}_t' \mathbf{D}_t^{-1} \mathbf{D}_t^{-1}\mathbf{\epsilon}_t \right]}_{\ell_{V}(\Theta_1)\text{ volatility component}} \underbrace{-\frac{1}{2} \sum_{t=1}^T \left[ -\mathbf{z}_t'\mathbf{z}_t + \ln(|\mathbf{R}_t|)+ \mathbf{z}_t' \mathbf{R}_t^{-1} \mathbf{z}_t \right]}_{\ell_{C}(\Theta_1, \Theta_2)\text{ correlation component}}\]</div>
</div>
<p>This decomposition reveals an interesting fact. We can view the
loglikelihood as sum of two components.</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\ell_{V}(\Theta_1)\)</span> is about the conditioal variances of the
returns.</p></li>
<li><p><span class="math notranslate nohighlight">\(\ell_{C}(\Theta_1, \Theta_2)\)</span> is about the conditional
correlation.</p></li>
</ol>
</section>
</section>
<section id="two-step-quasi-maximum-likelihood-qml">
<h2>Two-step quasi-maximum likelihood (QML)<a class="headerlink" href="#two-step-quasi-maximum-likelihood-qml" title="Link to this heading">#</a></h2>
<p>The above loglikelihood decomposition suggests a twp-step approach in
MLE.</p>
<p>Specifically, given the assumption of multivariate normal, the
volatility component <span class="math notranslate nohighlight">\(\ell_{V}(\Theta_1)\)</span> is the sum of individual
GJR-GARCH loglikelihood. It can be maximized by separately maximizing each
univariate model. So, we can separately estimate for each returns a
GJR-GARCH model via MLE, and add up the loglikelihoods. This is the first
step.</p>
<p>After the first step, we have the parameters
<span class="math notranslate nohighlight">\(\Theta_1=(\mu,\omega,\alpha,\gamma,\beta)\)</span> for the GJR-GARCH models, and we
can then estimate the remaining parameters <span class="math notranslate nohighlight">\(\Theta_2=(a, b)\)</span>.</p>
</section>
<section id="bivariate-case">
<h2>Bivariate case<a class="headerlink" href="#bivariate-case" title="Link to this heading">#</a></h2>
<p>The return equations for the two time series at time <span class="math notranslate nohighlight">\(t\)</span> are:</p>
<div class="math-wrapper docutils container" id="equation-return-eqn-1">
<div class="math notranslate nohighlight" id="equation-return-eqn-1">
<span class="eqno">(9)<a class="headerlink" href="#equation-return-eqn-1" title="Link to this equation">#</a></span>\[r_{1t} = \mu_1 + \epsilon_{1t}\]</div>
</div>
<div class="math-wrapper docutils container" id="equation-return-eqn-2">
<div class="math notranslate nohighlight" id="equation-return-eqn-2">
<span class="eqno">(10)<a class="headerlink" href="#equation-return-eqn-2" title="Link to this equation">#</a></span>\[r_{2t} = \mu_2 + \epsilon_{2t}\]</div>
</div>
<p>Here, <span class="math notranslate nohighlight">\(\epsilon_{1t} = \sqrt{h_{1t}} z_{1t}\)</span> and
<span class="math notranslate nohighlight">\(\epsilon_{2t} = \sqrt{h_{2t}} z_{2t}\)</span>, with <span class="math notranslate nohighlight">\(z_{1t}, z_{2t}
\sim N(0,1)\)</span>.</p>
<p>The conditional variances <span class="math notranslate nohighlight">\(h_{1t}\)</span> and <span class="math notranslate nohighlight">\(h_{2t}\)</span> are
specified as:</p>
<div class="math-wrapper docutils container" id="equation-h1">
<div class="math notranslate nohighlight" id="equation-h1">
<span class="eqno">(11)<a class="headerlink" href="#equation-h1" title="Link to this equation">#</a></span>\[h_{1t} = \omega_1 + \alpha_1 \epsilon_{1,t-1}^2 + \gamma_1 \epsilon_{1,t-1}^2 I_{1,t-1} + \beta_1 h_{1,t-1}\]</div>
</div>
<div class="math-wrapper docutils container" id="equation-h2">
<div class="math notranslate nohighlight" id="equation-h2">
<span class="eqno">(12)<a class="headerlink" href="#equation-h2" title="Link to this equation">#</a></span>\[h_{2t} = \omega_2 + \alpha_2 \epsilon_{2,t-1}^2 + \gamma_2 \epsilon_{2,t-1}^2 I_{2,t-1} + \beta_2 h_{2,t-1}\]</div>
</div>
<p>Here, <span class="math notranslate nohighlight">\(I_{i,t-1} = 1\)</span> if <span class="math notranslate nohighlight">\(\epsilon_{i,t-1} &lt; 0\)</span> and 0 otherwise.</p>
<p>The dynamic conditional correlation <span class="math notranslate nohighlight">\(\rho_t\)</span> is given by:</p>
<div class="math-wrapper docutils container" id="equation-rho-t">
<div class="math notranslate nohighlight" id="equation-rho-t">
<span class="eqno">(13)<a class="headerlink" href="#equation-rho-t" title="Link to this equation">#</a></span>\[\rho_t = \frac{q_{12t}}{\sqrt{q_{11t} q_{22t}}}\]</div>
</div>
<p>The Q process is updated as follows:</p>
<div class="math-wrapper docutils container" id="equation-q11">
<div class="math notranslate nohighlight" id="equation-q11">
<span class="eqno">(14)<a class="headerlink" href="#equation-q11" title="Link to this equation">#</a></span>\[q_{11t} = (1 - a - b) \overline{q}_{11} + a z_{1,t-1} z_{1,t-1} + b q_{11,t-1}\]</div>
</div>
<div class="math-wrapper docutils container" id="equation-q12">
<div class="math notranslate nohighlight" id="equation-q12">
<span class="eqno">(15)<a class="headerlink" href="#equation-q12" title="Link to this equation">#</a></span>\[q_{12t} = (1 - a - b) \overline{q}_{12} + a z_{1,t-1} z_{2,t-1} + b q_{12,t-1}\]</div>
</div>
<div class="math-wrapper docutils container" id="equation-q22">
<div class="math notranslate nohighlight" id="equation-q22">
<span class="eqno">(16)<a class="headerlink" href="#equation-q22" title="Link to this equation">#</a></span>\[q_{22t} = (1 - a - b) \overline{q}_{22} + a z_{2,t-1} z_{2,t-1} + b q_{22,t-1}\]</div>
</div>
<p>The log-likelihood function <span class="math notranslate nohighlight">\(\ell\)</span> can be decomposed into two
components:</p>
<div class="math-wrapper docutils container" id="equation-log-likelihood-total">
<div class="math notranslate nohighlight" id="equation-log-likelihood-total">
<span class="eqno">(17)<a class="headerlink" href="#equation-log-likelihood-total" title="Link to this equation">#</a></span>\[\ell = \ell_{V}(\Theta_1) + \ell_{C}(\Theta_1, \Theta_2)\]</div>
</div>
<p>The first part, <span class="math notranslate nohighlight">\(\ell_{V}(\Theta_1)\)</span>, is the sum of individual
GJR-GARCH log-likelihoods and is given by:</p>
<div class="math-wrapper docutils container" id="equation-ll-volatility">
<div class="math notranslate nohighlight" id="equation-ll-volatility">
<span class="eqno">(18)<a class="headerlink" href="#equation-ll-volatility" title="Link to this equation">#</a></span>\[\ell_{V}(\Theta_1) = -\frac{1}{2} \sum_{t=1}^T \left[ 2\ln(2\pi) + \ln(h_{1t}) + \ln(h_{2t}) + \frac{\epsilon_{1t}^2}{h_{1t}} + \frac{\epsilon_{2t}^2}{h_{2t}} \right]\]</div>
</div>
<p>The second part, <span class="math notranslate nohighlight">\(\ell_{C}(\Theta_1, \Theta_2)\)</span>, focuses on the
correlation and is given by:</p>
<div class="math-wrapper docutils container" id="equation-ll-correlation">
<div class="math notranslate nohighlight" id="equation-ll-correlation">
<span class="eqno">(19)<a class="headerlink" href="#equation-ll-correlation" title="Link to this equation">#</a></span>\[\ell_{C}(\Theta_1, \Theta_2) = -\frac{1}{2} \sum_{t=1}^T \left[ -\left(z_{1t}^2 + z_{2t}^2\right) + \ln(1 - \rho_t^2) + \frac{z_{1t}^2 + z_{2t}^2 - 2\rho_t z_{1t} z_{2t}}{1 - \rho_t^2} \right]\]</div>
</div>
<p>Here,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(z_{1t}\)</span> and <span class="math notranslate nohighlight">\(z_{2t}\)</span> are the standardized residuals.</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_t\)</span> is the dynamic conditional correlation, derived from
<span class="math notranslate nohighlight">\(q_{11t}\)</span>, <span class="math notranslate nohighlight">\(q_{12t}\)</span>, and <span class="math notranslate nohighlight">\(q_{22t}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Theta_1\)</span> includes the parameters for the individual GJR-GARCH
models: <span class="math notranslate nohighlight">\(\mu_1, \omega_1, \alpha_1, \gamma_1, \beta_1, \mu_2, \omega_2,
\alpha_2, \gamma_2, \beta_2\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Theta_2\)</span> includes the parameters for the DCC model:
<span class="math notranslate nohighlight">\(\alpha, \beta\)</span>.</p></li>
</ul>
</section>
<section id="esimation-techniques">
<h2>Esimation techniques<a class="headerlink" href="#esimation-techniques" title="Link to this heading">#</a></h2>
<p>My implementation of <a class="reference internal" href="#frds.algorithms.GJRGARCHModel_DCC" title="frds.algorithms.GJRGARCHModel_DCC"><code class="xref py py-class docutils literal notranslate"><span class="pre">frds.algorithms.GJRGARCHModel_DCC</span></code></a> fits the
GJR-GARCH-DCC model by a two-step quasi-maximum likelihood (QML) method.</p>
<p>Step 1. Use <a class="reference internal" href="../gjr-garch/#frds.algorithms.GJRGARCHModel" title="frds.algorithms.GJRGARCHModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">frds.algorithms.GJRGARCHModel</span></code></a> to estimate the
<a class="reference internal" href="../gjr-garch/"><span class="doc">GJR-GARCH(1,1)</span></a> model for each of the returns. This step yields
the estimates <span class="math notranslate nohighlight">\(\hat{\Theta}_1\)</span>, including parameters for the
individual GJR-GARCH models: <span class="math notranslate nohighlight">\(\mu_1, \omega_1, \alpha_1, \beta_1,
\mu_2, \omega_2, \alpha_2, \beta_2\)</span>. We obtain also the maximized
log-likelihood <span class="math notranslate nohighlight">\(\ell(\hat{\Theta}_1)\)</span>.</p>
<p>Step 2. Use the estimated parameters from Step 1 to maximize
<span class="math notranslate nohighlight">\(\ell_{C}(\hat{\Theta}_1, \Theta_2)\)</span> with respect to
<span class="math notranslate nohighlight">\(\Theta_2=(a,b)\)</span>. A grid search is performed to find the starting values
of <span class="math notranslate nohighlight">\((a,b)\)</span> based on loglikelihood.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://doi.org/10.2307/1912773">Engle, R. F. (1982)</a>,
“Autoregressive Conditional Heteroskedasticity with Estimates of the
Variance of United Kingdom Inflation.” <em>Econometrica</em>, 50(4),
987-1007.</p></li>
<li><p><a class="reference external" href="https://doi.org/10.2307/2109358">Bollerslev, T. (1990)</a>,
“Modelling the Coherence in Short-Run Nominal Exchange Rates: A
Multivariate Generalized ARCH Model.” <em>Review of Economics and
Statistics</em>, 72(3), 498-505.</p></li>
<li><p><a class="reference external" href="https://doi.org/10.1111/j.1540-6261.1993.tb05128.x">Glosten, L. R., Jagannathan, R., &amp; Runkle, D. E. (1993)</a>, “On the Relation Between the Expected Value and the Volatility of the Nominal Excess Return on Stocks.” <em>The Journal of Finance</em>, 48(5), 1779-1801.</p></li>
<li><p><a class="reference external" href="https://www.jstor.org/stable/1392121">Engle, R. (2002)</a>, “Dynamic
Conditional Correlation: A Simple Class of Multivariate Generalized
Autoregressive Conditional Heteroskedasticity Models.” <em>Journal of
Business &amp; Economic Statistics</em>, 20(3), 339-350.</p></li>
<li><p><a class="reference external" href="https://www.jstor.org/stable/1392122">Tse, Y.K. and Tsui, A.K.C. (2002)</a>,
“A Multivariate Generalized Autoregressive Conditional Heteroskedasticity Model with Time-Varying Correlations.”
<em>Journal of Business &amp; Economic Statistics</em>, 20(3), 351-362.</p></li>
</ul>
</section>
<section id="api">
<h2>API<a class="headerlink" href="#api" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="frds.algorithms.GJRGARCHModel_DCC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">frds.algorithms.</span></span><span class="sig-name descname"><span class="pre">GJRGARCHModel_DCC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">returns1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../gjr-garch/#frds.algorithms.GJRGARCHModel" title="frds.algorithms._garch.GJRGARCHModel"><span class="pre">GJRGARCHModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">returns2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../gjr-garch/#frds.algorithms.GJRGARCHModel" title="frds.algorithms._garch.GJRGARCHModel"><span class="pre">GJRGARCHModel</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/frds/algorithms/_mgarch/#GJRGARCHModel_DCC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#frds.algorithms.GJRGARCHModel_DCC" title="Link to this definition">#</a></dt>
<dd><p><a class="reference internal" href="#"><span class="doc">GJR-GARCH(1,1) - DCC</span></a> model with the following specification:</p>
<ul class="simple">
<li><p>Bivariate</p></li>
<li><p>Constant mean</p></li>
<li><p>Normal noise</p></li>
</ul>
<p>It estimates the model parameters only. No standard errors calculated.</p>
<dl class="py method">
<dt class="sig sig-object py" id="frds.algorithms.GJRGARCHModel_DCC.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">returns1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../gjr-garch/#frds.algorithms.GJRGARCHModel" title="frds.algorithms._garch.GJRGARCHModel"><span class="pre">GJRGARCHModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">returns2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../gjr-garch/#frds.algorithms.GJRGARCHModel" title="frds.algorithms._garch.GJRGARCHModel"><span class="pre">GJRGARCHModel</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../_modules/frds/algorithms/_mgarch/#GJRGARCHModel_DCC.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#frds.algorithms.GJRGARCHModel_DCC.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>returns1</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><a class="reference internal" href="../gjr-garch/#frds.algorithms.GJRGARCHModel" title="frds.algorithms.GJRGARCHModel"><em>GJRGARCHModel</em></a><em>]</em>) – <code class="docutils literal notranslate"><span class="pre">(T,)</span></code> array of <code class="docutils literal notranslate"><span class="pre">T</span></code> returns of first asset. Can also be an <a class="reference internal" href="../gjr-garch/#frds.algorithms.GJRGARCHModel" title="frds.algorithms.GJRGARCHModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">frds.algorithms.GJRGARCHModel</span></code></a>.</p></li>
<li><p><strong>returns2</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>, </em><a class="reference internal" href="../gjr-garch/#frds.algorithms.GJRGARCHModel" title="frds.algorithms.GJRGARCHModel"><em>GJRGARCHModel</em></a><em>]</em>) – <code class="docutils literal notranslate"><span class="pre">(T,)</span></code> array of <code class="docutils literal notranslate"><span class="pre">T</span></code> returns of second asset. Can also be an <a class="reference internal" href="../gjr-garch/#frds.algorithms.GJRGARCHModel" title="frds.algorithms.GJRGARCHModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">frds.algorithms.GJRGARCHModel</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">returns</span></code> is an array, it is best to be percentage returns for optimization.</p>
<p>Estimated <a class="reference internal" href="../gjr-garch/#frds.algorithms.GJRGARCHModel" title="frds.algorithms.GJRGARCHModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">frds.algorithms.GJRGARCHModel</span></code></a> can be used to save computation time.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="frds.algorithms.GJRGARCHModel_DCC.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#frds.algorithms.GJRGARCHModel_DCC.Parameters" title="frds.algorithms._mgarch.GJRGARCHModel_DCC.Parameters"><span class="pre">Parameters</span></a></span></span><a class="reference internal" href="../../_modules/frds/algorithms/_mgarch/#GJRGARCHModel_DCC.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#frds.algorithms.GJRGARCHModel_DCC.fit" title="Link to this definition">#</a></dt>
<dd><p>Estimates the Multivariate GJR-GARCH(1,1)-DCC parameters via twp-step QML</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#frds.algorithms.GJRGARCHModel_DCC.Parameters" title="frds.algorithms.GJRGARCHModel_DCC.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">frds.algorithms.GJRGARCHModel_DCC.Parameters</span></code></a></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#frds.algorithms.GJRGARCHModel_DCC.Parameters" title="frds.algorithms.GJRGARCHModel_DCC.Parameters">Parameters</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="frds.algorithms.GJRGARCHModel_DCC.Parameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">frds.algorithms.GJRGARCHModel_DCC.</span></span><span class="sig-name descname"><span class="pre">Parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglikelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#frds.algorithms.GJRGARCHModel_DCC.Parameters" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h2>
<p>Let’s import the dataset.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_url</span> <span class="o">=</span> <span class="s2">&quot;https://www.stata-press.com/data/r18/stocks.dta&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">convert_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Scale returns to percentage returns for better optimization results</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">returns1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;toyota&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">returns2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;nissan&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
<section id="frds">
<h3>frds<a class="headerlink" href="#frds" title="Link to this heading">#</a></h3>
<p>Use <a class="reference internal" href="#frds.algorithms.GJRGARCHModel_DCC" title="frds.algorithms.GJRGARCHModel_DCC"><code class="xref py py-class docutils literal notranslate"><span class="pre">frds.algorithms.GJRGARCHModel_DCC</span></code></a> to estimate a GJR-GARCH(1,1)-DCC.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">frds.algorithms</span> <span class="kn">import</span> <span class="n">GJRGARCHModel_DCC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_dcc</span> <span class="o">=</span> <span class="n">GJRGARCHModel_DCC</span><span class="p">(</span><span class="n">returns1</span><span class="p">,</span> <span class="n">returns2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">model_dcc</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="go">Parameters(mu1=0.03425396110878375,</span>
<span class="go">           omega1=0.02870349714933671,</span>
<span class="go">           alpha1=0.0629604836797677,</span>
<span class="go">           gamma1=0.012013473922807561,</span>
<span class="go">           beta1=0.9217503095555597,</span>
<span class="go">           mu2=0.010528449295629098,</span>
<span class="go">           omega2=0.05512898468355955,</span>
<span class="go">           alpha2=0.07700974411970742,</span>
<span class="go">           gamma2=0.021814015760057957,</span>
<span class="go">           beta2=0.9013499076166999,</span>
<span class="go">           a=0.04192697529292123,</span>
<span class="go">           b=0.8978328716537962,</span>
<span class="go">           loglikelihood=-7259.03519837521)</span>
</pre></div>
</div>
<p>These results are slighly different from the ones obtained in R, but with
marginally better loglikelihood overall.</p>
</section>
<section id="r">
<h3>R<a class="headerlink" href="#r" title="Link to this heading">#</a></h3>
<p>In R, we can estimate the DCC-GRJGARCH(1,1) as</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">rmgarch</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">haven</span><span class="p">)</span>
<span class="n">stocks</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_dta</span><span class="p">(</span><span class="s">&quot;https://www.stata-press.com/data/r18/stocks.dta&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">toyota</span><span class="o">=</span><span class="n">stocks</span><span class="o">$</span><span class="n">toyota</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">nissan</span><span class="o">=</span><span class="n">stocks</span><span class="o">$</span><span class="n">nissan</span><span class="o">*</span><span class="m">100</span><span class="p">)</span>
<span class="n">uspec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">multispec</span><span class="p">(</span><span class="nf">replicate</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="nf">ugarchspec</span><span class="p">(</span><span class="n">mean.model</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">armaOrder</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)),</span>
<span class="w">                                          </span><span class="n">variance.model</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s">&quot;gjrGARCH&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">garchOrder</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)))))</span>
<span class="n">dccspec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">dccspec</span><span class="p">(</span><span class="n">uspec</span><span class="o">=</span><span class="n">uspec</span><span class="p">,</span><span class="w"> </span><span class="n">dccOrder</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">distribution</span><span class="o">=</span><span class="s">&quot;mvnorm&quot;</span><span class="p">)</span>
<span class="n">dcc_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">dccfit</span><span class="p">(</span><span class="n">dccspec</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">dcc_fit</span>
</pre></div>
</div>
<p>The results are:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="o">*---------------------------------*</span>
<span class="o">*</span><span class="w">          </span><span class="n">DCC</span><span class="w"> </span><span class="n">GARCH</span><span class="w"> </span><span class="n">Fit</span><span class="w">          </span><span class="o">*</span>
<span class="o">*---------------------------------*</span>

<span class="n">Distribution</span><span class="w">         </span><span class="o">:</span><span class="w">  </span><span class="n">mvnorm</span>
<span class="n">Model</span><span class="w">                </span><span class="o">:</span><span class="w">  </span><span class="nf">DCC</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
<span class="n">No.</span><span class="w"> </span><span class="n">Parameters</span><span class="w">       </span><span class="o">:</span><span class="w">  </span><span class="m">13</span>
<span class="p">[</span><span class="n">VAR</span><span class="w"> </span><span class="n">GARCH</span><span class="w"> </span><span class="n">DCC</span><span class="w"> </span><span class="n">UncQ</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="m">0+10+2+1</span><span class="p">]</span>
<span class="n">No.</span><span class="w"> </span><span class="n">Series</span><span class="w">           </span><span class="o">:</span><span class="w">  </span><span class="m">2</span>
<span class="n">No.</span><span class="w"> </span><span class="n">Obs.</span><span class="w">             </span><span class="o">:</span><span class="w">  </span><span class="m">2015</span>
<span class="n">Log</span><span class="o">-</span><span class="n">Likelihood</span><span class="w">       </span><span class="o">:</span><span class="w">  </span><span class="m">-7260.429</span>
<span class="n">Av.Log</span><span class="o">-</span><span class="n">Likelihood</span><span class="w">    </span><span class="o">:</span><span class="w">  </span><span class="m">-3.6</span>

<span class="n">Optimal</span><span class="w"> </span><span class="n">Parameters</span>
<span class="o">-----------------------------------</span>
<span class="w">               </span><span class="n">Estimate</span><span class="w">  </span><span class="n">Std.</span><span class="w"> </span><span class="n">Error</span><span class="w">  </span><span class="n">t</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="nf">Pr</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span><span class="p">)</span>
<span class="p">[</span><span class="n">toyota</span><span class="p">]</span><span class="n">.mu</span><span class="w">      </span><span class="m">0.035250</span><span class="w">    </span><span class="m">0.031485</span><span class="w">  </span><span class="m">1.11959</span><span class="w"> </span><span class="m">0.262887</span>
<span class="p">[</span><span class="n">toyota</span><span class="p">]</span><span class="n">.omega</span><span class="w">   </span><span class="m">0.029322</span><span class="w">    </span><span class="m">0.015296</span><span class="w">  </span><span class="m">1.91701</span><span class="w"> </span><span class="m">0.055237</span>
<span class="p">[</span><span class="n">toyota</span><span class="p">]</span><span class="n">.alpha1</span><span class="w">  </span><span class="m">0.064252</span><span class="w">    </span><span class="m">0.015871</span><span class="w">  </span><span class="m">4.04852</span><span class="w"> </span><span class="m">0.000052</span>
<span class="p">[</span><span class="n">toyota</span><span class="p">]</span><span class="n">.beta1</span><span class="w">   </span><span class="m">0.920387</span><span class="w">    </span><span class="m">0.017760</span><span class="w"> </span><span class="m">51.82272</span><span class="w"> </span><span class="m">0.000000</span>
<span class="p">[</span><span class="n">toyota</span><span class="p">]</span><span class="n">.gamma1</span><span class="w">  </span><span class="m">0.011615</span><span class="w">    </span><span class="m">0.017344</span><span class="w">  </span><span class="m">0.66967</span><span class="w"> </span><span class="m">0.503066</span>
<span class="p">[</span><span class="n">nissan</span><span class="p">]</span><span class="n">.mu</span><span class="w">      </span><span class="m">0.009901</span><span class="w">    </span><span class="m">0.036277</span><span class="w">  </span><span class="m">0.27292</span><span class="w"> </span><span class="m">0.784911</span>
<span class="p">[</span><span class="n">nissan</span><span class="p">]</span><span class="n">.omega</span><span class="w">   </span><span class="m">0.057227</span><span class="w">    </span><span class="m">0.029777</span><span class="w">  </span><span class="m">1.92185</span><span class="w"> </span><span class="m">0.054625</span>
<span class="p">[</span><span class="n">nissan</span><span class="p">]</span><span class="n">.alpha1</span><span class="w">  </span><span class="m">0.079891</span><span class="w">    </span><span class="m">0.035086</span><span class="w">  </span><span class="m">2.27702</span><span class="w"> </span><span class="m">0.022785</span>
<span class="p">[</span><span class="n">nissan</span><span class="p">]</span><span class="n">.beta1</span><span class="w">   </span><span class="m">0.898218</span><span class="w">    </span><span class="m">0.031844</span><span class="w"> </span><span class="m">28.20660</span><span class="w"> </span><span class="m">0.000000</span>
<span class="p">[</span><span class="n">nissan</span><span class="p">]</span><span class="n">.gamma1</span><span class="w">  </span><span class="m">0.021556</span><span class="w">    </span><span class="m">0.023028</span><span class="w">  </span><span class="m">0.93610</span><span class="w"> </span><span class="m">0.349221</span>
<span class="p">[</span><span class="n">Joint</span><span class="p">]</span><span class="n">dcca1</span><span class="w">     </span><span class="m">0.042226</span><span class="w">    </span><span class="m">0.010225</span><span class="w">  </span><span class="m">4.12983</span><span class="w"> </span><span class="m">0.000036</span>
<span class="p">[</span><span class="n">Joint</span><span class="p">]</span><span class="n">dccb1</span><span class="w">     </span><span class="m">0.897648</span><span class="w">    </span><span class="m">0.031025</span><span class="w"> </span><span class="m">28.93326</span><span class="w"> </span><span class="m">0.000000</span>
</pre></div>
</div>
<p>These are more comparable to the results of <a class="reference internal" href="#frds.algorithms.GJRGARCHModel_DCC" title="frds.algorithms.GJRGARCHModel_DCC"><code class="xref py py-class docutils literal notranslate"><span class="pre">frds.algorithms.GJRGARCHModel_DCC</span></code></a>,
because the package <code class="docutils literal notranslate"><span class="pre">rmgarch</span></code> also uses a 2-stage approach.</p>
</section>
<section id="stata">
<h3>Stata<a class="headerlink" href="#stata" title="Link to this heading">#</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Stata does not support multivariate GJR-GARCH with DCC.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">tarch</span></code> option is not allowed for <code class="docutils literal notranslate"><span class="pre">-mgarch-</span></code> command.</p>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../datasets/">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Datasets</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../gjr-garch/">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">GJR-GARCH(1,1)</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023 - 2024, Mingze Gao
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/mgao6767/frds" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">GJR-GARCH(1,1) - DCC</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#return-equation">Return equation</a></li>
<li><a class="reference internal" href="#shock-equation">Shock equation</a></li>
<li><a class="reference internal" href="#conditional-covariance-matrix">Conditional covariance matrix</a></li>
<li><a class="reference internal" href="#log-likelihood-function">Log-likelihood function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#two-step-quasi-maximum-likelihood-qml">Two-step quasi-maximum likelihood (QML)</a></li>
<li><a class="reference internal" href="#bivariate-case">Bivariate case</a></li>
<li><a class="reference internal" href="#esimation-techniques">Esimation techniques</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#api">API</a><ul>
<li><a class="reference internal" href="#frds.algorithms.GJRGARCHModel_DCC"><code class="docutils literal notranslate"><span class="pre">GJRGARCHModel_DCC</span></code></a><ul>
<li><a class="reference internal" href="#frds.algorithms.GJRGARCHModel_DCC.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li><a class="reference internal" href="#frds.algorithms.GJRGARCHModel_DCC.fit"><code class="docutils literal notranslate"><span class="pre">fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#frds.algorithms.GJRGARCHModel_DCC.Parameters"><code class="docutils literal notranslate"><span class="pre">Parameters</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#frds">frds</a></li>
<li><a class="reference internal" href="#r">R</a></li>
<li><a class="reference internal" href="#stata">Stata</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=187304be"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=35a8b989"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>